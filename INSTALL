INSTALL - Anleitung zur Installation von UNIX-Connect
=====================================================

      Dies ist nur eine Kurzversion. Die offizielle Dokumentation
      zur Installation von UNIX-Connect ist im TeXinfo-Format in der Datei
      docs/uconn.texi zu finden.

      Derzeit (v0.87) ist allerdings diese Datei bereits aktualisiert,
      docs/uconn.texi aber noch auf Stand von v0.53...

      Diese Datei ist neu geschrieben zur Anpassung an das neue
      configure-Script von Andreas Barth <aba@muenchen.pro-bahn.de>.

      Datum: 22. Oktober 1999

      Unix-Connect ist freie Software und unterliegt der GPL. Näheres
      in der Datei COPYING.


Folgendes ist zu tun:

1. Nutzer- / Gruppenkennung
---------------------------

UNIX-Connect benoetigt eine User-ID, unter der die Gateway-Programme
arbeiten und Daten an das Mail- und News-System weitergeben. Auch die
Logfiles gehoeren diesem User und sollten nur von ihm lesbar sein.

Eine passende Nutzer- und Gruppenkennung aussuchen und ggf. anlegen



2. ./configure <parameter>.
---------------------------

Im Gegensatz zu früher wird hier wirklich _nur_ konfiguriert,
Dateien oder Verzeichnisse werden nur _im_ Quellcode-Baum
angelegt.

Die Parameter können sein:


--with-path=path         Path innerhalb von UC (Default=PATH).

Welchen Wert die Variable PATH innerhalb von ZC-Programmen hat.
Im Path müssen beispielsweise sz/rz gefunden werden können.

--with-dir=dir           In welches Unterverzeichnis die Dateien kommen.
--with-execdir=dir       In welches Verzeichnis die Programme kommen.
--with-confdir=dir       In welches Verzeichnis die Konfiguration kommt.


Defaultmäßig kommen alle Programme nach <libexedir>/<dir>,
alle Konfigurationsdateien nach <sysconfdir>/<dir>. Der
Default für <dir> ist zconnect.

Die Änderungen von --with-execdir und --with-confdir überschreiben
die von --with-dir.

(siehe auch --prefix, --exec-prefix, --libexecdir, --sysconfdir)


--with-spooldir=dir      Spooldir.

Wo die Spoolfiles hinkommen.

Default: /var/spool/zconnect, falls /var/spool existiert,
sonst /usr/spool/zconnect


--with-user=user         Nutzerkennung für Unix-Connect
--with-group=group       Gruppenkennung für Unix-Connect

Diese beiden Parameter _müssen_ angegeben werden.


--with-box=typ           point, gate, server

UNIX-Connect kann sehr vielseitig einsetzen werden. Die häufigsten
Konfigurationen sind:

   1) Point:    Als persönliches System. Unix-Connect wird als Point
                an einer Z-NETZ MailBox eingesetzt. Achtung, in diesem
                Fall dürfen keine Daten auf der RFC-Seite weitergegeben
                werden.
   2) Gateway:  Der Rechner hat nichts mit dem Z-NETZ zu tun,
                aber andere Systeme moechten von Ihnen Mail/News
                per ZCONNECT (bzw. JANUS) beziehen.
   3) Server:   Als MailBox im Z-Netz. UNIX-Connect macht Verbindungen zu
                anderen MailBoxen sowie zu Points.

Wenn Sie unsicher sind, waehlen Sie die (3). Damit wird eine Vollversion
installiert.
Für (1) bitte point, für (2) gate und für (3) server verwenden.


--with-mail=typ          Welches Mailsystem wird verwendet?
--with-news=typ          Welches Newssystem wird verwendet?

Es gibt folgende Mailsysteme:
sendmail, smail und qmail

Es gibt folgende Newssysteme:
cnews, inn

Wird nichts angegeben, dann wird "no" gewählt. Damit wird nur
ein Minimal-System installiert. Bitte die READMEs in
mail-and-news/<...> beachten.


--with-apc               APC einkompilieren (meist unnötig).

Hiermit wird eine sehr selten benoetigte Erweiterung fuer
spezielle Binaermails hereincompiliert (fuer APC Unix software).


--disable-full-gate       Nachrichten zurückkonvertieren verbieten.

Falls Sie Verbindungen ins Usenet haben, die nicht über ZConnect-Strecken
laufen, dürfen Sie Nachrichten, die aus dem Usenet stammen, nicht mehr nach
RFC zurückwandeln, da diese (prinzipbedingt) verändert worden sind.

UNIX/Connect unterbindet die Rückkonvertierung von Usenet-Artikeln, indem
beim Konvertieren nach ZConnect ein entsprechender Header gesetzt wird,
damit sie nicht wieder in das Usenet gesendet werden. Mit dieser Option
kann das Rückkonvertieren wieder ermöglicht werden.


--disable-log-xheader    Fehler nicht in X-Header protokollieren.

Ein Fehler beim Parsing wird in eine X-Header geschrieben,
so bleibt die Information erhalten, die nicht konvertiert wurde.
X-Bogus-Newsgroups-*:
X-Gate-Error:
X-Date-Error:
Mit dieser Option wird keiner cwder Header erzeugt.


--disable-uucp-server    Nicht alle Header erzeugen, für reine Leafsites.

Wandlung und Erzeugen von Headerzeilen für die Rückkonvertierung
unterbinden. Die Gatebau wird hier weitgehend nicht berücksichtigt.
Die UUCP/RFC Informationen werden am Gate weggeworfen.
Es gehen fast alle wesentlichen Informationen verloren.
Ein Rückwandeln dieser Nachrichten führt zu erheblichen Problemen.


--disable-iso-in-mail    Umlaute in Mail mit us-ascii umschreiben.

Dies Flag legt fest, das bei Mail eine
Umlautwandlung PC437 --> ISO-8859-1 nicht stattfindet.
Wird das entsprechende Flag definiert, wird ae, oe, ue benutzt.


--disable-iso-in-news    Umlaute in News mit us-ascii umschreiben.

Dies Flag legt fest, das bei News eine
Umlautwandlung PC437 --> ISO-8859-1 nicht stattfindet.
Wird das entsprechende Flag definiert, wird ae, oe, ue benutzt.


--disable-rot-for-maps   Sonderbehandlung des ROT-Headers für MAPS.

Es gibt in der Behandlung des Routstrings Unterschiede zwischen
ZConnect und RFC. Die allgemeine Einigung sieht so aus, dass die
RFC-Notation einfach in den ZC-ROT:-Header kopiert wird. Das vermeidet
Probleme nach dem Zurueckgaten, auch wenn die Routstrings streng nach
ZC falsch sind (der letzte Eintrag muesste verworfen werden).
Leider fuehrt das dazu, dass Nachrichten an den Pseudouser MAPS eines
Zerberus-Systems nicht anerkannt werden. Daher gibt es die Option,
bei Nachrichten an MAPS@* den Routstring auf ZConnect-Format zu stutzen.
Das sollte eigentlich keine Probleme machen.


--disable-nouser-in-rot  Sonderbehandlung für Usernamen im ROT-Header.

Usernamen werden inormalerweise nicht in den ROT-Header überrnommen.
Mit dieser Option wird erzwungen, das alle Namen aus der Path-Zeile
in den Rot-Header übernommen werden.


--disable-janus-checksum Checksummer der Seriennummer unterdrücken.

Durch die Checksumme wird das Ender der Vorpackphase erkannt.
Damit kann Zmodem auf beiden Seiten glichzeitig gestarrtet
werden. Anderenfalls können die Daten verloren gehen,
falls Zmodem mit einem "Echo" spricht.


--disable-rsmtp          Eigene Programme für Batched SMTP.

Zusatzpaket mit den Programmen "rsmtp" und "bsmtp" deaktivieren.
Wird für Sendmail (Copyright: Sendmail, Inc.) benötigt.
Das bstmp-Paket von Felix Schröter ist ebenfals geeignet.


--disable-online         Onlinefunktionen für Janus und ZConnect.

Deaktiviert alle Online-Funktionen. Erzeugt und installiert
werden nur noch die reinen Gateway-Programme.


--enable-bang            Bang-Pfade erzeugen.

UNIX-Connect erzeugt Nachrichten im BSMTP-Format. Für die
Weiterverarbeitung mit UUCP-Programmen sollten die Envelope-Adressen
in Bang-Notation erzeugt werden, für die Weiterverarbeitung mit qmail
nicht. Den meisten Programmen ist es egal.


--enable-uxheader        Erzeuge aus X-Headern => U-X-Header.

Vor Gatebau97 wurden alle X-Header als U-X-Header gegagetet.
Sie werden auch weiterhin zurückkonvertiert.
Nach dem Gatebau Beschuß, werden X- Header nun nicht mehr
verändert, sondern 1:1 durchgereicht.


--enable-badheader       Ignoriere defekte Header.

Wenn ungültige Headerzeilen gelesen werden, so werden diese mit
dieser Option ignoriert. Header-Namen mit 8-Bit Zeichen oder
Leerzeichen werden so aus den Nachrichten entfert.
Nach RFC1034 sollten solche Artikel nicht verändert werden,
sondern einfach entsorgt werden.


--enable-zmodemhack      Ignoriere Zmodem Fehler.

Leider hat das normalerweise verwendete rz von Omen Technologies
die Eigenart, einen unmotivierten Fehlerwert von 128 zurueckzugeben,
dem ich noch keinen Fehler zuordnen konnte. UNIX/Connect kann diesen
Wert (nur die 128) auf Wunsch ignorieren.
Dies ist normalerweise ein Abbruch, dieser Hack
kann zu Datenverlusten führen.


--enable-iso-in-zconnect Erzeuge ISO-Charset in ZConnect.

Diese Flag definiert, ob beim Uebergang von RFC -> ZCONNECT
eine ISO-8859-1 --> PC437 Konvertierung stattfindet,
wenn die RFC-Nachricht ISO-8859-1-Zeichen enthaelt.
Das Ganze fuehrt dazu, dass Nachrichten nicht mehr unbedingt unveraendert
durch ZConnect hindurchgereicht werden und sollte mit Vorsicht genossen
werden. Andererseits koennen viele Leute keine ISO-8859-1-Nachrichten
lesen, weil ihre ZConnect-Programme den entsprechenden ZConnect-Header
nicht auswerten.


--enable-point-messageid Erzeuge Message-IDs für Points.

Der ZConnect-Standard schreibt fuer Message-IDs von Points eine bestimmte
Form vor ( <lokalteil>@<point>.<server>.<do>.<main> ). Diese Form
kann vom Gateway erzwungen werden. Das kann aber dazu fuehren,
dass die Bezugsverkettung im Point nicht mehr sauber funktioniert...

--enable-uuencode-chksum Erzeuge Prüfsummen mit uuencode.

Den Ausgabezeilen der Funktion "uuencode" zwird eine Prüfsumme
anhehängt. Wird nicht überall unterstützt.


--enable-short-spooldir  Verwende kurze Namen für Verzeichnisse.

Mir dieser Option wird nur der Systemname ohne den Domainteil
als Name des Verzeichnis genommen. Nur für das Gateway,
Online-Programme und Scripte müssen von Hand angepaßt werden.


--enable-slow-modem      Lege eine Pause für langsame Modems ein.

Verzögerung für langsame Modem in Online-Teil.


--enable-auto-create     Erzeuge Spoolverzeichisse im Betrieb.

Das Gateway erzeugt automatisch die Spoolverzeichnisse für die
ZConnect-Systeme.


--enable-noempty-subject Fälsche das Subject wenn es leer ist.

NCB-Mail Systeme lehnen Nachricht ab wenn der Betreff leer ist.
Der Betreff wird hier auf "-" geändert.


--enable-testing         Verwende neuen Onlinecode.

Neue Funktion in import.c und call.c verwenden.
Noch in der Test-Phase.


--with-dialprae=code     Wählcode (Default=atdt).

Was einem Wählbefehl vorausgestellt werden soll. Im Zweifelsfall auch den
Rauswahlcode für die Nebenstellenanlage angeben (zB atdp0,).


--with-ortswahl=code     Ortsvorwahl (Default=0).
--with-intwahl=code      Internationale Vorwahl (Default=00).

Eigentlich selbsterklärend.


--with-sys=sys           Systemname.
--with-domain=domain     Domainname.

dito.



Die Dateien include/policy.h, include/config.h, include/sysdep.h,
Makefile und Makefile.global können vor dem Übersetzen angeschaut
und evtl. korregiert werden. Vor dem Installieren sollen die
Dateien in etc/, insbesondere etc/myself.zconnect und myself.config,
angepasst werden. Die Dateien in etc werden nur installiert, wenn
sie noch nicht vorhanden sind.


3. Übersetzen
-------------

make


4. Installieren
---------------

make install

make install
muß von Root ausgeführt werden.



5. Points/Systeme anlegen
-------------------------

Für jedes bekannte System (auch Points) muß eine Datei in
zcondir/systems vorhanden sein. Das nähere dazu steht
in README.systeme.



6. Login-Accounts einrichten
----------------------------

Wenn Sie ZCONNECT oder JANUS Anrufe entgegennehmen koennen moechten,
brauchen Sie einen Login fuer das jeweilige Verfahren:

   Login         Verfahren        Bemerkung
 -----------------------------------------------------------------------
   janus         JANUS            der Login-Prompt muss "Username:" sein.
   zconnect      ZCONNECT-3.1     Login-Prompt muss "ogin" oder "ame"
                                  enthalten (Gross/Kleinschreibung wird
                                  ignoriert)
 -----------------------------------------------------------------------

Es müssen login-Möglichkeiten für janus und zconnect geschaffen werden.
Nach dem Einloggen muß Zugriff auf die Dateien geschaffen werden, sprich
die Programme müssen unter der User-ID der bei configure angegebenen
Kennung laufen.

Als Alternative zum Eintrag in die Passwort-Datei kann auch mittels
mgetty der Login realisiert werden.



7. In das Mail- und Newssystem einbinden
----------------------------------------

Bitte in den passenden READMEs in den Unterverzeichnissen von
mail-and-news nachschauen, wie das beim jeweiligen System geht.



8. Mail und News regelmäßig packen
----------------------------------

Wenn andere Systeme anrufen, so müssen regelmäßig die Daten gepackt
werden. Dies kann beispielsweise durch Aufruf von <bindir>/prearc
aus der Root-Crontab erfolgen.

Außerdem sollten hin und wieder die back*-Verzeichnisse aufgeräumt
werden.


9. Fertig
---------

Viel Spaß.



Andi Barth <aba@muenchen.pro-bahn.de>
