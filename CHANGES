
$Id$

Aenderungen an UnixConnect
seit 0.80

- postfix Support (Matthias Andree) 

- uufatal.c, ruft jetzt newlog() auf.

- call.c: Anrufzeit vereinfacht.

- Erweiterung des Log-Systems. (Andreas Barth, Dirk Meyer)

- lib, includes aufgeräumt. Fehlenede und doppelte Prototypen korregiert.
  sources includen ihr eigenes Interface.

- zconv.c: MIME_ENC_HEADER, MIME default ...

- uuconv.c: CONVERT_ISO darf nich wahlfrei für Kommentare sein.

- uursmtp: Neue Option: -s
  uursmtp -s (FQDN-ZCONNECT-Host) (Envelope-Sender) (Envelope-Empfänger)
  Envelope-Empfänger darf mehrfach auftreten
  Liest Mail mit RFC-822-Header und -Body aber OHNE BSMTP-Enveloper von stdin,
  schreibt Ausgabe in Spooldirectory.
  Motivation: um direkten Aufruf aus Postfix-pipe zu ermöglichen.
  (Matthias Andree) 

- IBMs Postfix wird nun unterstützt (Matthias Andree)
  Integration ist dank neuer uursmtp-Option trivial.

- strdup-Kollision beseitigt: (Matthias Andree)

- zcall: verhindert blocking bei Oeffnen des seriellen Ports
  jetzt auch unter Linux (Matthias Andree)
  gibt nach beendetem erfolgreichem Netcall den Port wieder frei.

- xprog.c: kompletter rewrite, führt überall Fehlerabfragen ein, wichtige
  Neuerungen: 1) runcommand(); 2) erheblich besser wartbar
  3) sx ist jetzt sz -X, alle Programme werden in /usr/bin erwartet
  (Matthias Andree), Cleanup der Typ-Konflikite (Dirk Meyer)

- strlib.a: neue Funktionen stccpy und qstccpy. Sind Varianten von strncpy,
  die nur so viele Bytes wie nötig kopieren und IMMER für Nullterminierung
  sorgen. ALLE strncpy sollten umgestellt werden.
  Wenig getestet. (Matthias Andree)

- anruf.in entrümpelt, Variablen eingebaut (Matthias Andree)

- Nonblocking IO wieder abschalten (Matthias Andree)

- redesign der Funktion import_all() (Matthias Andree)
  Fehler gehen nicht mehr verloren.

- Zusammenfassung in gtools.h gtools.c
  Exclusive Suche von Dateien gefixt (Matthias Andree)

- Sendmail/cnews jetzt generiert.

- Makefiles weiter optimiert.
  install/uninstall jetzt verfügbar

- Code aufgrund von Warnings gesaeubert.
  mehrfache lokale Varaiblen, const, u.s.w.

- uursmtp/uurnews schliesst die Datein richtig,
  und versucht nicht die Pipe zu loeschen.
  Systemname bei Pipe ist obsolete.
  Exitcodes aus <sysexits.h> verwenden.

- uuwsmtp/uuwnews schliesst die Datein richtig,
  und versucht nicht die Pipe zu loeschen.
  Id für Multipart jetzt immer gesetzt.
  Exitcodes aus <sysexits.h> verwenden.
  Pointuser wird in allen Optionen gesetzt.

- install-sh eingebaut, (C) 1991 MIT
  (Matthias Andree)

- Makefiles, die helpers/subst aufrufen, tun dies jetzt durch
  $(SHELL) (Matthias Andree)

- Aufraeumarbeiten an Typen, signed/unsigned/printf konsistent
  (Matthias Andree)    

- Syslog ueber FACILITY=LOCAL0 statt MAIL

seit 0.79

- Makefiles weitgehend ueberarbeiet

- Syslog über configure automatisch erkennen

- configure respektiert CFLAGS

- bsmtp/rsmtp Pakete hinzugefügt

- GNU configure eingebaut

- Die Gateprogramme verstehen "-p" für Pipe. (Andreas Barth)

- retryverhalten von call verbessert (Matthias Andree)

seit 0.78

- stderr umleiten in Datei, um tty nicht zu stoeren
  in januslogin und receiver

- "!not-for-mail" im Pfad erzeugen, wenn point dies nicht sendet.

- References wieder mit Whitespaces

- Option fuer syslogd -D LOGSYSLOG

- Fehler bei bestimmten base64-Laengen behoben

- erzeuge X-Header statt U-X-Header
  Altes Verhalten mit #define NO_PLUS_KEEP_X_HEADER

- U-Header nach ISO konvertieren,
  war schon vorgesehen aber nicht aktiv.

seit 0.77

- port fuer BSD generish

- Hardwarehandshake NEED_CRTSCTS bei Linux und FreeBSD

- neuer gperf 2.7 zum erzeugen von hash.c

- Korrektes Errechnen der Lokalzeit
  wenn das Datum durch Sommerzeit verstellt wurde.

- Robuster bei defekten newgroups/rmgroups

- Vermeidung von doppelten ABS, MID, WAB
  Der alte Code funktionierte nicht.

- Vermeidung von doppleten ROT: Headern

- Path-Header in Mails verwerfen.

- mode-reset bei Verbindugsabbruch

seit 0.76b1

Vorbemerkung: Die rcs/cvs-Id-Zeilen sind neu gestartet, weil ich das CVSROOT
neu installieren mußte.

- Code leicht aufgeräumt: Ein paar 'const' eingefügt und für den gcc ein paar
  Attribute definiert (weniger unnötige Warnungen, Syntaxcheck für uufatal und
  logfile). Return-Codes standardisiert, ein buffer-overflow (konnte der
  überhaupt auftreten?) in decode_mime_string beseitigt.

- minireadstat bricht bei fehlerhaften Konfigurationsdateien ab (z.B. kein
  Eintrag System-Name, beliebter Fehler...)

- Die Erzeugung der Bcc:-Header aus KOP: bei STAT: NOKOP ist wieder
  rausgeflogen. Stattdessen werden bei STAT: NOKOP die KOP:-Header gelöscht,
  die haben da eh nicht da zu sein. Korrekterweise müßte das Gate bei
  STAT:NOKOP die Mail aufsplitten, das ist leider nicht so ganz einfach zu
  realisieren.

- decode_mime_string verbessert, '_' -> ' ' fehlte.

- Fehlermeldungen (STAT: ERR) in Mails erhalten einen leeren
  Envelope-From. (vgl. rfc 821, Abschnitt 3.6, Absatz 8)

- References werden nicht mehr umgebrochen, der Headertext enthält per
  definition keinen Whitespace.

- inn/send-zcon und smail/zbatchsmtp jetzt mit Fehlerbehandlung

- Neu: qmail-Skripte

seit 0.76

- neue Compile-Option: RCPT_WITH_BANG. Beeinflußt, ob im
  Envelope-Header Bang- oder @-Notation verwendet wird.

- neue Routine decode_mime_string dekodiert RFC2047-kodierte Strings
  Testprogramm gate/testmime liegt bei.

- Header mit Textcharakter werden bei ZC->RFC nach RFC2047
  und beim RFC->ZC auch zurück gewandelt.

- Für Mail ohne Message-ID wird eine erzeugt.

- KOP wird nur nach CC/BCC gewandelt, wenn der entsprechende Header
  noch nicht existiert. (Bislang: Nur, wenn CC noch nicht existiert.)

- Interessanter Nebeneffekt: Beim regression test sind ein paar
  Nachrichten aufgefallen, die von den vorherigen Versionen
  weggeschmissen wurden.

- Bugfixes


seit 0.75b4

- Alias-Erkennung Case-Insensitiv.

- Fehler beim uuencode deoden wird bei Bedarf zurückgegeben.

- Fehlerhafte uuencodete Nachrichten führen nicht zum Abbruch, sondern
  werden durchgereicht.

- Bei Cancel-Nachrichten wird die gecancelte Nachricht bei der Wandlung nach
  ZC in den BEZ mit eingetragen, wenn sie noch nicht drinstand. Ist nach ZC
  Doku vorgeschrieben.

- uursmtp.c: Logging korrigiert.

- Nachrichten mit STAT:CTL bekommen einen leeren Envelope-Absender

- Bei Mail werden keine Lines:/Path:-Header erzeugt.

- "Message-ID" wird jetzt wie im so1036 geschrieben.

- FreeBSD: Änderungen von Dirk Meyer eingespielt.

- Automatische Erkennung Sommer/Winterzeit, wenn nicht in der config
  gesetzt.


seit 0.75b3

- uudecode bekommt einen festen Dateinamen vorgesetzt. Damit braucht das
  Programm nicht mehr nach der dekodierten Datei zu suchen und uudecode
  kommt nicht auf den Gedanke, eine falsche Datei zu überschreiben. Evtl.
  kann auch noch das Erzeugen eines temp-Directories herausfliegen.

- Beim Dekodieren von UNIX/Connect-Multipart-Nachrichten wird die korrekte
  Länge in den Header eingetragen.

- Nachrichten am Dateiende mit falschem LEN-Header werden jetzt wenigstens
  soweit wie möglich konvertiert und nicht abgeschnitten.

- Beim uuencode wird nicht mehr der Text "SP_MULTIPART_BOUNDARY" angehängt,
  sondern das Boundary

- Der ZC-Vertreter landet nicht im Envelope-Absender.

- Falsche Newsgroup-Namen werden tatsächlich nur ausgegeben, wenn ihr Header
  auch geschrieben wird.

- Es wird nur noch ein Envelope-From ausgegeben.

- Header, die nur einmal auftreten dürfen, werden nur einmal ausgegeben.

- RFC-Header werden nach RFC822 umbrochen. Dafür gibt es neue Routinen in
  zconv.c

- In call.c fehlte im Teil, der ge-fork()-t wurde, ein _exit(0).

seit 0.75b2

- neue Kompilier-Option: LOG_ERRORS_IN_HEADERS (default: ja). Hiermit werden
  Parse-Fehler in X-Headern vermerkt.

- ZC-Brettnamen werden etwas intensiver geprüft.

- printbretter komplett neu (Dirk)

- einige Pointer-Bugs korrigiert, führten zum Absturz

- einige Speicherlöcher im Zusammenhang mit MIME beseitigt.

- EB mehrfach.

- zbatchsmtp: Datenloch gestopft, Dateien werden nur noch gelöscht, wenn
  uursmtp nicht fehlgeschlagen ist.

seit 0.75b1

- Hinweise auf Modem-Locking in PROBLEMS eingefügt.

- Schreibfehler aus alias.c korrigiert.

- in uuconv.c Adressparsing verbessert.

- convaddr hat jetzt einen Parameter, wieviele Adressen gewandelt werden
  sollen. Vorher gab es Ärger mit doppelten WAB und ABS-Headern.

- Ein mit '"' geklammerter Lokalteil der Adresse ohne Leerzeichen wird
  davon befreit. Auf ZC-Seite wird das als etwas anderes angesehen.

- Einige Header werden auf doppeltes Auftreten in X-ZC- geprüft.

- verbesserte Datumsroutinen

- verbesserte sendmail-Einbindung

- kleinere Bugfixes

seit 0.75

- An etlichen Stellen malloc gegen dalloc und strdup und str2dup gegen
  dstrdup ausgetauscht, Fehler in str2dup behoben, sollte trotzdem
  herausfliegen (doppelte Funktionalität).

- Etliche Patches der Liste eingefügt. (Dirk Meyer, TetiSoft)

- Resent-From: wird in WAB: gewandelt.

- Im export.log wird die Zeit mitgeloggt.

- uuwnews und uuwsmtp kennen jetzt eine weitere Option "-d", mit der
  Ein- und Ausgabedatei explizit angegeben werden können. Hauptsächlich
  für automatisiertes Testen sinnvoll. Die Eingabedatei wird nicht gelöscht.

- man-pages für uuwsmtp und uuwnews. Weitere werden folgen.

